<!DOCTYPE html>
<html lang="en">
<link rel="stylesheet" href="../static/resources/styles/style.css">
<link rel="stylesheet" href="../resources/styles/dropDown.css">

<head>
    <meta charset="UTF-8">
    <title>Visible V8 Web</title>
    <link rel="icon" type="image/x-icon" href="../resources/vv8logo/icon.ico" />
    <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="https://d3js.org/d3.v4.js"></script>
</head>


<body>

    <header>
        <ul class="navigation">
            <li class="left"><a href="history.html">History</a></li>
            <li class="title">
                <h1><a href="../static/index.html">Visible V8</a></h1>
            </li>
            <li class="right"><a href="../static/about.html">About</a></li>
        </ul>
        <div class="loading">
            <div class="loading-bar"></div>
        </div>
        <script src="../static/resources/scripts/ani.js"></script>
    </header>
    <main>

        <div class="centered">
            <h1>Results for URL Address</h1>
            <!--            <input type="file" id="fileInput">-->
        </div>
        <br>
        <hr>
        <br>
        <div class="results-container">
            <div class="resizeable column centered">
                <div>
                    <p>Chrome Web Tool integration</p>
                </div>
                <!-- chrome-dev-tool-like drawer  -->
                <div class="container">
                    <!-- Contenedor -->
                    <ul id="accordion" class="accordion">
                        <li>
                            <div class="link">Tree 1<i class="dropdown"></i></div>
                            <ul class="submenu">
                                <li><a href="#">sub 1</a></li>
                                <li><a href="#">sub 2</a></li>
                                <li><a href="#">sub 3</a></li>
                            </ul>
                        </li>
                        <li>
                            <div class="link">Tree 2<i class="dropdown"></i></div>
                            <ul class="submenu">
                                <li><a href="#">sub 1</a></li>
                                <li><a href="#">sub 2</a></li>
                                <li><a href="#">sub 3</a></li>
                            </ul>
                        </li>
                    </ul>


                </div>

            </div>
            <div class="resizeable column centered">
                <div>
                    <p>D3.js content</p>
                </div>
                <!-- pie chart -->
                <div>

                    <svg height="300" width="250" id="pie"></svg>
                    <script>
                        var data = [{
                            name: "get",
                            share: 40.01
                        }, {
                            name: "set",
                            share: 30.92
                        }, {
                            name: "function calls",
                            share: 15.42
                        }, {
                            name: "other",
                            share: 13.65
                        }];

                        var svg = d3.select("#pie"),
                            width = svg.attr("width"),
                            height = svg.attr("height"),
                            radius = Math.min(width, height) / 2,
                            g = svg.append("g").attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

                        var color = d3.scaleOrdinal(['#4daf4a', '#377eb8', '#ff7f00', '#984ea3', '#e41a1c']);
                        var ordScale = d3.scaleOrdinal()
                            .domain(data)
                            .range(['#ffd384', '#94ebcd', '#fbaccc', '#d3e0ea', '#fa7f72']);
                        // Generate the pie
                        var pie = d3.pie().value(function(d) {
                            return d.share;
                        });

                        // Generate the arcs
                        var arc = d3.arc()
                            .innerRadius(70)
                            .outerRadius(radius);

                        var label = d3.arc()
                            .innerRadius(30)
                            .outerRadius(radius + 20);

                        //Generate groups
                        var arcs = g.selectAll("arc")
                            .data(pie(data))
                            .enter()
                            .append("g")
                            .attr("class", "arc")

                        //Draw arc paths
                        arcs.append("path")
                            .attr("fill", function(d) {
                                return ordScale(d.data.name);
                            })
                            .attr("d", arc);

                        arcs.append('text')
                            .attr("transform", function(d) {
                                return "translate(" + label.centroid(d) + ")";
                            })
                            .text(function(d) {
                                return d.data.name;
                            })
                            .style("font-family", "arial")
                            .style("font-size", 15);
                    </script>
                </div>
                <!-- bar chart -->
                <div>

                    <svg width="600" height="500" id="bar"></svg>
                    <script>
                        var data = [{
                            name: "get",
                            share: 40.01
                        }, {
                            name: "set",
                            share: 30.92
                        }, {
                            name: "function calls",
                            share: 15.42
                        }, {
                            name: "other",
                            share: 13.65
                        }];

                        var svg = d3.select("#bar"),
                            margin = 200,
                            width = svg.attr("width") - margin,
                            height = svg.attr("height") - margin
                        svg.append("text")
                            .attr("transform", "translate(100,0)")
                            .attr("x", 50)
                            .attr("y", 50)
                            .attr("font-size", "24px");

                        var xScale = d3.scaleBand().range([0, width]).padding(0.4),
                            yScale = d3.scaleLinear().range([height, 0]);

                        xScale.domain(data.map(function(d) {
                            return d.name;
                        }));
                        yScale.domain([0, d3.max(data, function(d) {
                            return d.share;
                        })]);

                        var g = svg.append("g")
                            .attr("transform", "translate(" + 100 + "," + 100 + ")");

                        g.append("g")
                            .attr("transform", "translate(0," + height + ")")
                            .call(d3.axisBottom(xScale));

                        g.append("g")
                            .call(d3.axisLeft(yScale).tickFormat(function(d) {
                                return d;
                            }).ticks(10))
                            .append("text")
                            .attr("y", 6)
                            .attr("dy", "0.71em")
                            .attr("text-anchor", "end")
                            .text("value");
                        g.selectAll(".bar")
                            .data(data)
                            .enter().append("rect")
                            .attr("class", "bar")
                            .attr("x", function(d) {
                                return xScale(d.name);
                            })
                            .attr("y", function(d) {
                                return yScale(d.share);
                            })
                            .attr("width", xScale.bandwidth())
                            .attr("height", function(d) {
                                return height - yScale(d.share);
                            });
                    </script>
                </div>
                <!-- line chart, super cool, but might delete later -->
                <div id="my_dataviz"></div>
                <script>
                    // set the dimensions and margins of the graph
                    var margin = {
                            top: 10,
                            right: 30,
                            bottom: 30,
                            left: 60
                        },
                        width = 460 - margin.left - margin.right,
                        height = 400 - margin.top - margin.bottom;

                    // append the svg object to the body of the page
                    var svg = d3.select("#my_dataviz")
                        .append("svg")
                        .attr("width", width + margin.left + margin.right)
                        .attr("height", height + margin.top + margin.bottom)
                        .append("g")
                        .attr("transform",
                            "translate(" + margin.left + "," + margin.top + ")");

                    //Read the sample data
                    d3.csv("https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/5_OneCatSevNumOrdered.csv", function(data) {

                        // group the data: I want to draw one line per group
                        var sumstat = d3.nest() // nest function allows to group the calculation per level of a factor
                            .key(function(d) {
                                return d.name;
                            })
                            .entries(data);

                        // Add X axis --> it is a date format
                        var x = d3.scaleLinear()
                            .domain(d3.extent(data, function(d) {
                                return d.year;
                            }))
                            .range([0, width]);
                        svg.append("g")
                            .attr("transform", "translate(0," + height + ")")
                            .call(d3.axisBottom(x).ticks(5));

                        // Add Y axis
                        var y = d3.scaleLinear()
                            .domain([0, d3.max(data, function(d) {
                                return +d.n;
                            })])
                            .range([height, 0]);
                        svg.append("g")
                            .call(d3.axisLeft(y));

                        // color palette
                        var res = sumstat.map(function(d) {
                                return d.key
                            }) // list of group names
                        var color = d3.scaleOrdinal()
                            .domain(res)
                            .range(['#e41a1c', '#377eb8', '#4daf4a', '#984ea3', '#ff7f00', '#ffff33', '#a65628', '#f781bf', '#999999'])

                        // Draw the line
                        svg.selectAll(".line")
                            .data(sumstat)
                            .enter()
                            .append("path")
                            .attr("fill", "none")
                            .attr("stroke", function(d) {
                                return color(d.key)
                            })
                            .attr("stroke-width", 1.5)
                            .attr("d", function(d) {
                                return d3.line()
                                    .x(function(d) {
                                        return x(d.year);
                                    })
                                    .y(function(d) {
                                        return y(+d.n);
                                    })
                                    (d.values)
                            })

                    })
                </script>
            </div>

        </div>
        <script src="../webpages/scripts/ani.js"></script>
    </main>
</body>

</html>